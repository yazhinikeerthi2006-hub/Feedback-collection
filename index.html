
<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Feedback Collection System</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#94a3b8; --accent:#60a5fa; --glass: rgba(255,255,255,0.03);
      --success:#10b981; --danger:#ef4444; --radius:12px;
      font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:linear-gradient(180deg,var(--bg),#071025); color:#e6eef8; -webkit-font-smoothing:antialiased;
      padding:28px; display:flex; align-items:flex-start; justify-content:center; gap:24px;
    }
    .container{max-width:1100px; width:100%; display:grid; grid-template-columns:1fr 420px; gap:22px; align-items:start}header{grid-column:1/-1; display:flex; gap:12px; align-items:center}
header h1{margin:0;font-size:20px}
header p{margin:0;color:var(--muted); font-size:13px}

.card{background:linear-gradient(180deg,var(--card), rgba(11,18,32,0.6)); padding:18px; border-radius:var(--radius); box-shadow:0 6px 16px rgba(2,6,23,0.6);}

form .row{display:flex; gap:12px}
label{display:block;font-size:13px;color:var(--muted); margin-bottom:8px}
input[type=text], input[type=email], select, textarea{width:100%; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:var(--glass); color:inherit; resize:vertical}
textarea{min-height:100px}

.field{margin-bottom:14px}
.actions{display:flex; gap:10px; align-items:center}
button{padding:10px 14px; border-radius:10px; border:0; cursor:pointer; font-weight:600}
.btn-primary{background:linear-gradient(90deg,var(--accent),#3b82f6); color:#042433}
.btn-ghost{background:transparent; color:var(--accent); border:1px solid rgba(96,165,250,0.18)}
.muted{color:var(--muted); font-size:13px}

/* right column */
.side{position:sticky; top:28px; height:fit-content;}
.list{max-height:600px; overflow:auto; padding:6px}
.entry{display:flex; gap:10px; align-items:center; justify-content:space-between; padding:8px; border-radius:10px; margin-bottom:8px; background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent)}
.entry small{color:var(--muted)}
.pill{background:rgba(255,255,255,0.03); padding:6px 8px; border-radius:999px; font-size:12px}

footer{grid-column:1/-1; margin-top:6px; color:var(--muted); font-size:12px}

/* responsive */
@media (max-width:980px){
  .container{grid-template-columns:1fr;}
  .side{position:relative}
}

/* tiny helpers */
.flex{display:flex; gap:8px; align-items:center}
.space{flex:1}
.danger{background:linear-gradient(90deg,var(--danger),#ef6a6a); color:#120205}
.success{background:linear-gradient(90deg,var(--success),#34d399); color:#042411}
.rating-stars{display:flex; gap:6px}
.rating-stars button{padding:8px 10px; border-radius:8px; background:transparent; border:1px solid rgba(255,255,255,0.03)}
.small{font-size:12px}
.center{display:flex; justify-content:center; align-items:center}

  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>Feedback Collection System</h1>
        <p>Collect user feedback, view entries, export CSV. Works offline using localStorage.</p>
      </div>
    </header><main class="card">
  <form id="feedbackForm" novalidate>
    <div class="field">
      <label for="name">Name</label>
      <input id="name" type="text" placeholder="Your name (optional)" />
    </div>

    <div class="field">
      <label for="email">Email</label>
      <input id="email" type="email" placeholder="you@example.com (optional)" />
    </div>

    <div class="field">
      <label for="category">Category</label>
      <select id="category">
        <option value="general">General</option>
        <option value="bug">Bug Report</option>
        <option value="feature">Feature Request</option>
        <option value="support">Support</option>
      </select>
    </div>

    <div class="field">
      <label>Rating</label>
      <div class="rating-stars" id="ratingStars" role="radiogroup" aria-label="Rating">
        <button type="button" data-value="1" aria-pressed="false">1</button>
        <button type="button" data-value="2" aria-pressed="false">2</button>
        <button type="button" data-value="3" aria-pressed="false">3</button>
        <button type="button" data-value="4" aria-pressed="false">4</button>
        <button type="button" data-value="5" aria-pressed="false">5</button>
      </div>
      <div class="muted small" id="ratingHint">Choose a rating (1-5)</div>
    </div>

    <div class="field">
      <label for="comment">Comments</label>
      <textarea id="comment" placeholder="Tell us what you liked or how we can improve..."></textarea>
    </div>

    <div class="field flex">
      <label class="small"><input id="anonymous" type="checkbox" /> Submit anonymously</label>
      <div class="space"></div>
      <div class="muted small">Entries stored in your browser only.</div>
    </div>

    <div class="actions">
      <button class="btn-primary" type="submit">Send Feedback</button>
      <button type="button" class="btn-ghost" id="previewBtn">Preview</button>
      <button type="button" class="btn-ghost" id="clearForm">Clear</button>
    </div>

  </form>

  <hr style="margin:18px 0; border:none; border-top:1px solid rgba(255,255,255,0.03)" />

  <section>
    <h3 style="margin:0 0 10px 0">Quick stats</h3>
    <div class="flex">
      <div class="pill">Total: <span id="totalCount">0</span></div>
      <div class="pill">Avg rating: <span id="avgRating">—</span></div>
      <div class="space"></div>
      <button id="exportCsv" class="btn-ghost">Export CSV</button>
      <button id="clearAll" class="danger">Clear All</button>
    </div>
  </section>
</main>

<aside class="card side">
  <h3 style="margin-top:0">Recent submissions</h3>
  <div class="list" id="entriesList" aria-live="polite"></div>
</aside>

<footer>
  Tip: Use <strong>Preview</strong> to see the formatted feedback before sending.
</footer>

  </div>  <template id="entryTemplate">
    <div class="entry">
      <div>
        <strong class="name">Name</strong>
        <div><small class="meta">Category • email • time</small></div>
        <div class="small comment">Comment</div>
      </div>
      <div class="flex">
        <div class="pill rating">5</div>
        <div>
          <button class="btn-ghost view">View</button>
          <button class="danger delete">Delete</button>
        </div>
      </div>
    </div>
  </template>  <!-- Preview modal (simple) -->  <div id="modal" style="display:none; position:fixed; inset:0; background:rgba(2,6,23,0.6); align-items:center; justify-content:center">
    <div style="width:680px; max-width:94%; background:var(--card); padding:18px; border-radius:12px; box-shadow:0 10px 30px rgba(2,6,23,0.7)">
      <div id="modalContent"></div>
      <div style="display:flex; gap:8px; justify-content:flex-end; margin-top:12px">
        <button id="modalClose" class="btn-ghost">Close</button>
        <button id="modalSend" class="btn-primary">Send</button>
      </div>
    </div>
  </div>  <script>
    // Simple client-side feedback system
    (function(){
      const form = document.getElementById('feedbackForm');
      const entriesList = document.getElementById('entriesList');
      const totalCount = document.getElementById('totalCount');
      const avgRating = document.getElementById('avgRating');
      const ratingButtons = document.querySelectorAll('#ratingStars button');
      const previewBtn = document.getElementById('previewBtn');
      const clearFormBtn = document.getElementById('clearForm');
      const exportCsvBtn = document.getElementById('exportCsv');
      const clearAllBtn = document.getElementById('clearAll');
      const modal = document.getElementById('modal');
      const modalContent = document.getElementById('modalContent');
      const modalClose = document.getElementById('modalClose');
      const modalSend = document.getElementById('modalSend');

      let selectedRating = 0;

      const LS_KEY = 'feedback_entries_v1';

      function loadEntries(){
        try{
          const raw = localStorage.getItem(LS_KEY);
          return raw ? JSON.parse(raw) : [];
        }catch(e){ console.error(e); return []; }
      }

      function saveEntries(list){
        localStorage.setItem(LS_KEY, JSON.stringify(list));
      }

      function render(){
        const entries = loadEntries();
        entriesList.innerHTML = '';
        if(entries.length===0){ entriesList.innerHTML = '<div class="muted small center">No submissions yet.</div>'; }
        entries.slice().reverse().forEach((e, idx) => {
          const tpl = document.getElementById('entryTemplate').content.cloneNode(true);
          tpl.querySelector('.name').textContent = e.anonymous ? 'Anonymous' : (e.name || '—');
          tpl.querySelector('.meta').textContent = ${capitalize(e.category)} • ${e.email || '—'} • ${new Date(e.at).toLocaleString()};
          tpl.querySelector('.comment').textContent = e.comment || '—';
          tpl.querySelector('.rating').textContent = e.rating || '—';
          const viewBtn = tpl.querySelector('.view');
          const delBtn = tpl.querySelector('.delete');
          viewBtn.addEventListener('click', ()=> showModal(e));
          delBtn.addEventListener('click', ()=> deleteEntry(e.id));
          entriesList.appendChild(tpl);
        });
        totalCount.textContent = entries.length;
        avgRating.textContent = computeAvg(entries) || '—';
      }

      function computeAvg(list){
        if(!list.length) return null;
        const vals = list.map(x=>Number(x.rating)||0).filter(n=>n>0);
        if(!vals.length) return null;
        const avg = vals.reduce((a,b)=>a+b,0)/vals.length;
        return (Math.round(avg*10)/10).toFixed(1);
      }

      function capitalize(s){ return (s||'').replace(/^./, c=>c.toUpperCase()); }

      function addEntry(obj){
        const entries = loadEntries();
        entries.push(obj);
        saveEntries(entries);
        render();
      }

      function deleteEntry(id){
        if(!confirm('Delete this entry?')) return;
        const entries = loadEntries().filter(e=>e.id!==id);
        saveEntries(entries);
        render();
      }

      function clearAll(){
        if(!confirm('Clear all feedback stored in this browser?')) return;
        localStorage.removeItem(LS_KEY);
        render();
      }

      function showModal(entry){
        modalContent.innerHTML = `
          <h3 style="margin-top:0">Feedback preview</h3>
          <p><strong>${entry.anonymous ? 'Anonymous' : (entry.name||'—')}</strong> • ${entry.email||'—'}</p>
          <p class="muted">Category: ${capitalize(entry.category)} • Rating: ${entry.rating||'—'}</p>
          <hr />
          <div style="white-space:pre-wrap">${escapeHtml(entry.comment||'—')}</div>
        `;
        modal.style.display='flex';
        modal.dataset.entryId = entry.id;
      }

      function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[c]); }

      function exportCsv(){
        const entries = loadEntries();
        if(!entries.length){ alert('No entries to export.'); return; }
        const header = ['id','name','email','anonymous','category','rating','comment','timestamp'];
        const rows = entries.map(e=>[
          e.id,
          csvSafe(e.name),
          csvSafe(e.email),
          e.anonymous ? 'true' : 'false',
          e.category,
          e.rating,
          csvSafe(e.comment),
          new Date(e.at).toISOString()
        ].join(','));
        const csv = [header.join(','), ...rows].join('\n');
        const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = 'feedback_export.csv';
        document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
      }

      function csvSafe(s){ if(s==null) return '""'; return '"'+String(s).replace(/"/g,'""')+'"'; }

      // Rating buttons behaviour
      ratingButtons.forEach(btn => {
        btn.addEventListener('click', ()=>{
          selectedRating = Number(btn.dataset.value);
          ratingButtons.forEach(b=> b.setAttribute('aria-pressed','false'));
          btn.setAttribute('aria-pressed','true');
          document.getElementById('ratingHint').textContent = 'Selected: '+selectedRating;
        });
      });

      // preview & modal handlers
      previewBtn.addEventListener('click', ()=>{
        const data = collectForm(false);
        if(!data) return; // validation will show alerts
        showModal(Object.assign({}, data, {id: 'preview-'+Date.now(), at: Date.now()}));
      });
      modalClose.addEventListener('click', ()=>{ modal.style.display='none'; modal.dataset.entryId=''; });
      modalSend.addEventListener('click', ()=>{
        const id = modal.dataset.entryId;
        if(!id) { modal.style.display='none'; return; }
        if(String(id).startsWith('preview-')){
          // create entry from current form
          const data = collectForm(true);
          if(!data) return;
          addEntry(data);
          modal.style.display='none';
          form.reset(); selectedRating=0; ratingButtons.forEach(b=>b.setAttribute('aria-pressed','false'));
          alert('Feedback sent and saved locally.');
        } else {
          // modal opened for an existing entry (view-only)
          modal.style.display='none';
        }
      });

      clearFormBtn.addEventListener('click', ()=>{ form.reset(); selectedRating=0; ratingButtons.forEach(b=>b.setAttribute('aria-pressed','false')); document.getElementById('ratingHint').textContent='Choose a rating (1-5)'; });

      exportCsvBtn.addEventListener('click', exportCsv);
      clearAllBtn.addEventListener('click', clearAll);

      form.addEventListener('submit', (ev)=>{
        ev.preventDefault();
        const data = collectForm(true);
        if(!data) return;
        addEntry(data);
        form.reset(); selectedRating=0; ratingButtons.forEach(b=>b.setAttribute('aria-pressed','false'));
        document.getElementById('ratingHint').textContent='Choose a rating (1-5)';
        alert('Thank you — your feedback was saved locally.');
      });

      function collectForm(requireComment){
        const name = document.getElementById('name').value.trim();
        const email = document.getElementById('email').value.trim();
        const category = document.getElementById('category').value;
        const comment = document.getElementById('comment').value.trim();
        const anonymous = document.getElementById('anonymous').checked;

        if(requireComment && !comment){ alert('Please add a comment before sending.'); return null; }
        if(email && !/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(email)){ alert('Please enter a valid email address.'); return null; }

        return {
          id: 'f_' + Date.now() + '_' + Math.random().toString(36).slice(2,8),
          name: name || '',
          email: email || '',
          anonymous: !!anonymous,
          category: category || 'general',
          rating: selectedRating || '',
          comment: comment || '',
          at: Date.now()
        };
      }

      // init
      render();

      // utility: keyboard shortcut to export (Ctrl+E)
      window.addEventListener('keydown', (e)=>{
        if((e.ctrlKey||e.metaKey) && e.key.toLowerCase()==='e'){ e.preventDefault(); exportCsv(); }
      });

    })();
  </script></body>
</html>
